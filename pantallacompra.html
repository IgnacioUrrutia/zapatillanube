<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gengar Market - Confirmación de Compra</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="stylesheet" href="css/pantallacompra.css">
  <link rel="stylesheet" href="css/cart.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="navbar-brand">Gengar Market</div>
      <ul class="navbar-nav">
        <li><a href="index.html">Inicio</a></li>
        <li><a href="productos.html">Productos</a></li>
        <li><a href="productos.html">Colección</a></li>
        <li><a href="https://www.instagram.com/gengar.market/" target="_blank">Contacto</a></li>
        <li>
          <a href="#" id="carrito-nav" class="nav-link">
            <i class="fas fa-shopping-cart"></i>
            <span id="contador-carrito" class="contador-carrito">0</span>
          </a>
        </li>
      </ul>
    </nav>
  </header>

  <main>
    <section class="compra-container">
      <h1>¡Gracias por tu compra!</h1>
      <p>Tu pedido ha sido recibido correctamente.</p>

      <div class="compra-detalle" id="detalle-compra">
        <!-- Aquí se insertarán los productos -->
      </div>

      <div class="compra-total" id="total-compra">Total: $0</div>

      <a href="productos.html" class="volver-btn" onclick="limpiarCompra()">Seguir Comprando</a>
      <button class="finalizar-btn" onclick="descargarBoleta()">Finalizar y Descargar Boleta</button>
    </section>
  </main>

  <footer style="background:#111; color:#fff; text-align:center; padding:1rem 0; font-size:0.9rem;">
    <p>&copy; 2024 Gengar Market. Todos los derechos reservados.</p>
  </footer>

  <script>
    const productosComprados = JSON.parse(localStorage.getItem('gengarUltimaCompra')) || [];
    const contenedor = document.getElementById('detalle-compra');
    const totalCompra = document.getElementById('total-compra');

    let total = 0;
    let htmlBoleta = '<h2>Boleta de Compra</h2><ul>';

    productosComprados.forEach(prod => {
      const linea = document.createElement('p');
      const texto = `${prod.nombre} x${prod.cantidad} - $${(prod.precio * prod.cantidad).toFixed(0)}`;
      linea.textContent = texto;
      contenedor.appendChild(linea);
      total += prod.precio * prod.cantidad;
      htmlBoleta += `<li>${texto}</li>`;
    });

    htmlBoleta += `</ul><strong>Total: $${total.toFixed(0)}</strong>`;
    totalCompra.textContent = `Total: $${total.toFixed(0)}`;

    function descargarBoleta() {
      const blob = new Blob([htmlBoleta], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'boleta_gengar.html';
      a.click();
      URL.revokeObjectURL(url);
      limpiarCompra();
    }

    function limpiarCompra() {
      localStorage.removeItem('gengarUltimaCompra');
    }
  </script>
  <script src="js/auth.js"></script>

</body>

</html>
